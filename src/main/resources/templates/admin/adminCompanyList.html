<!DOCTYPE html>
<html lang="ko" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/layout}">


<div layout:fragment="content">

    <style>        
        #menu_image_url, #logo_url{
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
    </style>

    <div class="container-fluid p-5 bg-danger text-white text-center">
        <h2>관리자 페이지</h2>
    </div>

    <div class="container mt-4 mb-5">
        <a href="/admin" type="button" class="text-secondary" >< 뒤로가기</a>
        <div class="text-center h4 mt-3" >회사 수정 및 삭제는 해당 회사의 이름을 클릭해주세요.</div>
    </div>
    
    <!-- Company List -->
    <div class="container mt-3 mb-5">
        <h2><strong>Company List</strong></h2>
        <p></p>
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>이름</th>
                    <th>Logo</th>
                    <th>Update Time</th>
                    <th>Create Time</th>
                    <th>Logo Image URL</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="c : ${companyList}">
                    <td><span th:text="${c.companyId}">ID</span></td>
                    <td>
                        <span th:text="${c.name}" data-bs-toggle="modal" th:data-bs-target="'#editCompanyModal'+${c.companyId}" >companyName</span>
                    </td>
                    <td><img th:src="${c.image}" height="30" data-bs-toggle="modal" th:data-bs-target="'#cLogoModal'+${c.companyId}" ></td>
                    <td><span th:text="${c.updatedAt}">updatedAt</span></td>
                    <td><span th:text="${c.createdAt}">createdAt</span></td>
                    <td><div th:text="${c.image}" style="width: 300px;" id="logo_url" >LogoImageUrl</div></td>
                    <!-- Company Logo Modal -->
                    <div class="modal" th:id="'cLogoModal'+${c.companyId}">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <!-- Modal Header -->
                                <div class="modal-header">
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>                
                                <!-- Modal body -->
                                <div class="modal-body">
                                    <img class="img-fluid" th:src="${c.image}">
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Edit Company Modal -->
                    <div class="modal" th:id="'editCompanyModal'+${c.companyId}">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <!-- Modal Header -->
                                <div class="modal-header">
                                    <h4 class="modal-title">회사 추가</h4>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <!-- Edit Form -->
                                <form th:action="@{/admin/companies/edit/}+${c.companyId}" method="POST">
                                    <!-- Modal body -->
                                    <div class="modal-body">
                                        <div class="mb-3 mt-3">
                                            <label>회사명</label>
                                            <input class="form-control" placeholder="회사명을 적어주세요" name="companyName" th:value="${c.name}">
                                        </div>
                                        <div class="mb-3">
                                            <label>회사 로고 이미지</label>
                                            <input class="form-control" placeholder="회사 로고 URL를 넣어주세요" name="companyLogo" th:value="${c.image}">
                                        </div>
                                    </div>
                                    <!-- Modal footer -->
                                    <div class="modal-footer">
                                        <button type="submit" class="btn btn-primary">저장</button>
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                                        <a class="btn btn-danger" data-bs-toggle="modal" th:href="'#delCompany'+${c.companyId}" role="button">삭제하기</a>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!-- delete form -->
                    <form th:action="@{/admin/companies/delete/}+${c.companyId}" th:method="DELETE">
                        <input type="hidden" name="_method" value="delete" >
                        <div class="modal fade" th:id="'delCompany'+${c.companyId}" aria-hidden="true" aria-labelledby="exampleModalToggleLabel"
                            tabindex="-1">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title fw-bold" id="exampleModalToggleLabel">경고</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <p class="fw-bold" style="color: tomato;">정말 해당 회사를 삭제하시겠습니까?</p>
                                        <p>회사를 삭제하시면 해당 회사와 연결된 메뉴 또한 모두 삭제됩니다.</p>
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-danger" type="submit" >삭제하기</button>
                                        <a class="btn btn-secondary" data-bs-dismiss="modal">취소</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </tr> <!-- end of th:each -->
            </tbody>
        </table>


    </div>




</div> <!-- end of container -->

</html>


